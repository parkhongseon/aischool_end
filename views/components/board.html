{%for board in data%}
{%if board.b_type == 'ëª¨ì§‘'%}
<a href="/detail?a={{ board.b_idx }}" class="post_idx" style=" color: black;">
    <section class="board">
        <div class="board__head">
            <span class="board__group" data-array="{{board.b_category}}" data-index="0" data-prepend="">-</span>

            <time class="board__deadline" data-array="{{board.b_category}}" data-prepend="ë§ˆê°ì¼ | "
                data-index="2">-</time>

        </div>
        <h1 class="board__title">{{board.b_title}}</h1>
        <p class="board__desc">{{ board.b_content | stripHtmlTags | truncate(30) }}</p>
        <div class="board__stack">
            <div data-array="{{board.b_category}}">
            </div>
        </div>
        {%else%}
        <a href="/detail?a={{ board.b_idx }}" class="post_idx" style=" color: black;">
            <section class="board">
                <div class="board__head">
                    <span class="board__group1">
                        ğŸ“‹&nbsp;ê²Œì‹œíŒ
                    </span>
                </div>
                <div class="board__middle">
                    <h1 class="board__title1">{{board.b_title}}</h1>
                    <p class="board__desc">{{ board.b_content | stripHtmlTags | truncate(20) }}</p>
                </div>
                {%endif%}
                <div class="board__footer">
                    <h5 class="board__name">{{board.user_name}}</h5>
                    <div>
                        <span class="board__like"><i class="fa-regular fa-eye"></i></span>
                        <span class="board__like">{{board.b_views}}</span>

                        <span class="board__view"><i class="fa-solid fa-heart"></i></span>
                        <span class="board__view">{{board.b_likes}}</span>
                    </div>
                </div>
            </section>
        </a>

        {%endfor%}



        <script>
            // JavaScriptë¡œ ë°ì´í„° ì†ì„±ì˜ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const category = document.querySelector('.board__group').getAttribute('data-array');

            // ì¹´í…Œê³ ë¦¬ì— ë”°ë¼ ì•„ì´ì½˜ì„ ê²°ì •í•©ë‹ˆë‹¤.
            let icon = '';
            if (category === 'í”„ë¡œì íŠ¸') {
                icon = 'ğŸš€ ';
            } else if (category === 'ìŠ¤í„°ë””') {
                icon = 'âœï¸ ';
            } else if (category === 'ê³µëª¨ì „') {
                icon = 'ğŸ’» ';
            }

            // ì•„ì´ì½˜ì„ í¬í•¨í•œ í…ìŠ¤íŠ¸ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
            const spanElement = document.querySelector('.board__group');
            spanElement.textContent = icon + spanElement.textContent;
            function populateElement(element) {
                // data-array, data-index ë° data-prepend ì†ì„±ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¨ ë‹¤ìŒ íŒŒì‹±í•©ë‹ˆë‹¤.
                const dataArrayRaw = element.getAttribute('data-array');
                const dataIndex = parseInt(element.getAttribute('data-index'), 10);
                const prependValue = element.getAttribute('data-prepend') || ''; // prepend ê°’ì„ ê°€ì ¸ì˜¤ê±°ë‚˜ ë¹ˆ ë¬¸ìì—´ ì‚¬ìš©
                const dataArray = JSON.parse(dataArrayRaw);

                // ì›í•˜ëŠ” ê°’ì„ ì¶”ì¶œí•˜ê³  "~"ë¥¼ ì¶”ê°€í•œ í›„ í‘œì‹œí•©ë‹ˆë‹¤.
                const displayValue = prependValue + dataArray[dataIndex];
                element.textContent = displayValue;
            }

            document.addEventListener('DOMContentLoaded', function () {
                // ì„ íƒí•œ ìš”ì†Œ ì²˜ë¦¬
                const customElements = document.querySelectorAll('.board__group, .board__deadline, .detail__table--desc');
                customElements.forEach((element) => {
                    populateElement(element);
                });
            });

            function formatDate(dateString) {
                const date = new Date(dateString);
                const formatter = new Intl.DateTimeFormat('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return formatter.format(date);
            }

            document.addEventListener('DOMContentLoaded', function () {
                const postDateElements = document.querySelectorAll('.post-date');
                postDateElements.forEach((element) => {
                    const rawDate = element.getAttribute('data-date');
                    const formattedDate = formatDate(rawDate);
                    element.textContent = formattedDate;
                });
            });
            //stack ì¶”ê°€ í‘œì‹œ
            function populateStack(element) {
                const dataArrayRaw = element.getAttribute('data-array');
                const dataArray = JSON.parse(dataArrayRaw);
                const stackArray = dataArray[3].slice(0, 3); // ì—¬ê¸°ë¥¼ ìˆ˜ì •í•˜ì—¬ ìµœëŒ€ 3ê°œì˜ ìŠ¤íƒë§Œ ê°€ì ¸ì˜µë‹ˆë‹¤.

                stackArray.forEach(stack => {
                    const stackSpan = document.createElement('span');
                    stackSpan.textContent = stack;
                    element.appendChild(stackSpan);
                });
            }

            document.addEventListener('DOMContentLoaded', function () {
                const customElements = document.querySelectorAll('.board__group, .board__deadline, .detail__table--desc, .board__stack div');
                customElements.forEach((element) => {
                    if (element.matches('.board__stack div')) {
                        populateStack(element);
                    } else {
                        populateElement(element);
                    }
                });
            });

        </script>